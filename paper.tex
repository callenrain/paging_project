\documentclass[twocolumn]{article}
%\documentclass{article}
\usepackage{fullpage}
% you really only need to use one of graphicx or epsfig
% there are example of using each one in this file
%\usepackage[dvips]{graphicx}
%usepackage{epsfig}
\usepackage{pgfplots}

% if you want two columns per page, but you also need to reformat the figures
% to span both columns if you do this
%\twocolumn
\begin{document}
\title{Testing Characteristics of the Linux Page Replacement Policy}

\author{Callen Rain \& Justin Cosentino}

\maketitle

\begin{abstract}
This paper describes some of the techniques used to identify the behavior of the Linux page replacement and discusses the implementation of a system call that provides page replacement statistics.  The system call provides page fault statistics for minor and major faults for a single process, processes grouped by owners, and all processes on the system. Several tests were developed that accessed large segments of memory on a Linux virtual machine. In each of the tests, access patterns exploited some page replacement scheme and favored others. An initial hypothesis of a Least Recently Used (LRU) algorithm was partially supported, although there was some evidence that the Linux implementation has characteristics resembling a working set. 
\end{abstract}

\section{Introduction}

We began with a hypothesis that the Linux system uses a Least Recently Used (LRU) page replacement algorithm, based on our analysis of the relevant kernel code and our numerous attempts in class to approximate this algorithm.  Our first few tests confirmed that the replacement policy is more like LRU than like Most Recently Used (MRU) or First In First Out (FIFO), but our test to find some distinction between LRU and a Working Set (WS) algorithm did lean in favor of some Working Set behavior rather than strict LRU. 


\section{System Call}
Our experimental methodology relies heavily on the page fault statistics system call that we implemented for the first part of this lab. The system call reports the number of page faults for all processes in the system, all the processes being run by the owner of the current process, or just the page faults for the current process. For each of these operations, the system call reports the major faults, minor faults, and the number of processes being reported on. We collected statistics primarily on major faults, as they are the page faults that result from having to replace pages in memory. 

The system call first does all the normal error checking, ensuring that the pointer passed in is writable and valid, that the process or processes requested exist, and that the flag is valid. We defined the ${\tt pf\_info\_struct()}$ 
and the included flags in a header file.  If the user enters a pid of -1, we used the ${\tt for\_each\_process()}$ macro to loop over all the processes, incrementing the major faults, minor faults, and number of processes for each one. We then fill the fields of the included struct. If the pid is positive, we check the inputted flag. If the flag is ${\tt PGFLTSTAT\_PROC}$, we do the same procedure for just the current process. If the flag is ${\tt PGFLTSTAT\_OWNER}$, we look for the owner id of the current process, and loop through all the processes again, collecting data only for the ones that share the uid. 

\section{Methodology}
\subsection{Experiments}
\subsubsection{Ruling Out Most Recently Used}
%--------------------------------------------%

\begin{figure}[h]
\begin{tikzpicture}
\begin{axis}[
    title = {MRU vs. LRU Test},
    width=8cm,
    xtick={1,...,2},
    xticklabels={1,2,3,4},
    grid=major,
    ybar, 
    bar width=10pt, 
    ylabel=Page Faults, 
    xlabel=Phase, 
    ymin=0, 
        enlarge x limits={abs=1}
    ]

\addplot[
    fill=blue!25,
    error bars/.cd,
        y dir=both,
        y explicit
] 
table [y error=error] {
x   y           error    label
1   8608.00 86.23 1
2   128.00 3.87 2
};

\addplot[
    fill=red!25,
    error bars/.cd,
        y dir=both,
        y explicit
] 
table [y error=error] {
x   y           error    label
1   7775.00   41.76 1
2   978.00   32.60 2
};
\legend{Case 1,Case 2}
\end{axis}
\end{tikzpicture}
\end{figure}

\begin{table}[h]
\begin{center}
\begin{tabular}{|c|c|r|r|}
\hline
{\bf Phase } & {\bf Case} & {\bf Page Faults} & {\bf Error } \\
\hline
1 & 1 & 8608.00 & $\pm$ 86.23 \\
& 2 & 7775.00 & $\pm$ 41.76 \\
\hline
2 & 1 & 128.00 & $\pm$ 3.87 \\
& 2 & 978.00 & $\pm$ 32.60 \\
\hline
\end{tabular}
\caption{ \label{rawio} MRU versus LRU test data
{\em  Description DescriptionDescriptionDescriptionDescription  }}
\end{center}
\end{table}

%--------------------------------------------%

\subsubsection{Ruling Out First In First Out}
%--------------------------------------------%
\begin{figure}[h]
\begin{tikzpicture}
\begin{axis}[
    title = {FIFO vs. LRU Test},
    width=8cm,
    xtick={1,...,4},
    xticklabels={1,2,3,4},
    grid=major,
    ybar, 
    bar width=10pt, 
    ylabel=Page Faults, 
    xlabel=Phase, 
    ymin=0, 
    enlarge x limits={abs=1}
    ]

\addplot[
    fill=blue!25,
    error bars/.cd,
        y dir=both,
        y explicit
] 
table [y error=error] {
x   y           error    label
1   7708.00 158.27 1
2   976.00 20.27 2
3   976.00 8.89 3
4   0.00 0.00 4
};

\addplot[
    fill=red!25,
    error bars/.cd,
        y dir=both,
        y explicit
] 
table [y error=error] {
x   y           error    label
1   6832.00   128.12 1
2   993.00   20.12 2
3   979.00   33.21 3
4   983.00   15.59 4
};
\legend{Case 1,Case 2}
\end{axis}
\end{tikzpicture}
\end{figure}

\begin{table}[h]
\begin{center}
\begin{tabular}{|c|c|r|r|}
\hline
{\bf Phase } & {\bf Case} & {\bf Page Faults} & {\bf Error } \\
\hline
1 & 1 & 7708.00 & $\pm$ 158.27 \\
& 2 & 6832.00 & $\pm$ 128.12 \\
\hline
1& 1 & 976.00 & $\pm$ 20.27 \\
& 2 & 993.00 & $\pm$ 20.12 \\
\hline
2 & 1 & 976.00 & $\pm$ 8.89 \\
& 2 & 979.00 & $\pm$ 33.21 \\
\hline
1 & 1 & 0.00 & $\pm$ 0.00 \\
& 2 & 983.00 & $\pm$ 15.59 \\
\hline
\end{tabular}
\caption{ \label{rawio} FIFO versus LRU test data
{\em  Description  }}
\end{center}
\end{table}

%--------------------------------------------%

\subsubsection{Balance Between Working Set Least Recently Used}
%--------------------------------------------%
\begin{figure}[h]
\begin{tikzpicture}
\begin{axis}[
    title = {Working Set vs. LRU Test},
    width=8cm,
    xtick={1,...,3},
    xticklabels={1,2,3,4},
    grid=major,
    ybar, 
    bar width=10pt, 
    ylabel=Page Faults, 
    xlabel=Phase, 
    ymin=0, 
    enlarge x limits={abs=1}
    ]

\addplot[
    fill=blue!25,
    error bars/.cd,
        y dir=both,
        y explicit
] 
table [y error=error] {
x   y           error    label
1   3614.00 131.24 1
2   1.00 1.00 2
3   3990.00 24.58 3
};

\addplot[
    fill=red!25,
    error bars/.cd,
        y dir=both,
        y explicit
] 
table [y error=error] {
x   y           error    label
1   5142.00   320.20 1
2   1.00   0.00 2
3   2163.00   13.96 3
};
\legend{Case 1,Case 2}
\end{axis}
\end{tikzpicture}
\end{figure}

\begin{table}[h]
\begin{center}
\begin{tabular}{|c|c|r|r|}
\hline
{\bf Phase } & {\bf Case} & {\bf Page Faults} & {\bf Error } \\
\hline
1 & 1 & 3614.00 & $\pm$ 131.24 \\
& 2 & 5142.00 & $\pm$ 320.20 \\
\hline
1& 1 & 1.00 & $\pm$ 1.00 \\
& 2 & 1.00 & $\pm$ 0.00 \\
\hline
2 & 1 & 3990.00 & $\pm$ 24.58 \\
& 2 & 2163.00 & $\pm$ 13.96 \\
\hline
\end{tabular}
\caption{ \label{rawio} Working Set versus LRU test data
{\em  Description  }}
\end{center}
\end{table}

%--------------------------------------------%

\subsubsection{Random LRU Behavior}

Main part: describe your experiments and results: For each experiment, you should:

Clearly state what your hypothesis is (i.e. "Application that does X should be a bad/good case for Linux's page replacement policy because ...)

Explain how your experiment is testing that hypothesis (We are testing this hypothesis by running application P, which does ..., N times on and collecting X,Y, and Z metrics using our system call, vmstat, time,... With these measures, we can see whether or not ... because ...).

Present your Results.

Explain your results! 
(Our results show that ... This does/does not match our expected result, because ... (if it doesn't, think about some other tests you could run to explain why it doesn't, or look for data you do have to explain it)

Quality of Experiments is much, much better than quantity; a few well thought out and well done experiments is sufficient.

\section{Conclusion}

It should include a statement of the major result(s) of your experiments (which policy(ies) is Linux's most like? and in what way(s)?). Also, tell me what you found to be the most difficult part of the hypothesis testing phase of this assignment.




\end{document}

